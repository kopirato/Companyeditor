<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Selelo Media Studio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #020617, #0f172a);
            color: #f8fafc;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .app {
            max-width: 520px;
            margin: auto;
            padding: 40px 20px;
            background: rgba(2, 6, 23, 0.8);
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .app:hover {
            transform: translateY(-5px);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            color: #38bdf8;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header p {
            color: #94a3b8;
            font-size: 15px;
            font-weight: 400;
        }

        .panel {
            background: #020617;
            border: 1px solid #0f172a;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
        }

        input[type="file"] {
            width: 100%;
            background: #020617;
            border: 1px dashed #334155;
            color: #f8fafc;
            padding: 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: border-color 0.3s ease, background 0.3s ease;
        }

        input[type="file"]:hover {
            border-color: #38bdf8;
            background: #0f172a;
        }

        .preview {
            margin-top: 25px;
            text-align: center;
            position: relative;
        }

        canvas, video {
            width: 100%;
            border-radius: 12px;
            margin-top: 15px;
            display: none;
            background: black;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            transition: opacity 0.5s ease;
        }

        .controls {
            margin-top: 25px;
        }

        button {
            width: 100%;
            background: linear-gradient(135deg, #38bdf8, #0284c7);
            border: none;
            color: #020617;
            padding: 16px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background: linear-gradient(135deg, #0ea5e9, #0369a1);
            transform: translateY(-2px);
        }

        button:disabled {
            background: #334155;
            color: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        #status {
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            color: #94a3b8;
            transition: color 0.3s ease;
        }

        #status.success {
            color: #22c55e;
        }
    </style>
</head>

<body>

<div class="app">

    <div class="header">
        <h1>Selelo Corporate Media Studio</h1>
        <p>Upload images or videos → Enhance → Logo → Download</p>
    </div>

    <div class="panel">
        <input type="file" id="upload" accept="image/*,video/*">

        <div class="preview">
            <canvas id="canvas"></canvas>
            <video id="video" controls></video>
        </div>

        <div class="controls">
            <button id="download" disabled>Download Branded Media</button>
        </div>

        <p id="status"></p>
    </div>
</div>

<script>
const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const video = document.getElementById("video");
const ctx = canvas.getContext("2d");
const downloadBtn = document.getElementById("download");
const status = document.getElementById("status");

let finalBlob = null;
let currentType = null;

// Load logo
const logo = new Image();
logo.src = "11.png"; // Your logo file
logo.onload = ()=>console.log("Logo loaded");
logo.onerror = ()=>alert("Missing: 11.png in repo root");

// Upload handler
upload.addEventListener("change", e=>{
    const file = e.target.files[0];
    if(!file) return;

    downloadBtn.disabled = true;
    finalBlob = null;
    status.textContent = "Processing...";

    if(file.type.startsWith("image")){
        currentType = "image";
        processImage(file);
    }else if(file.type.startsWith("video")){
        currentType = "video";
        processVideo(file);
    }else{
        alert("Unsupported file type");
    }
});

// ================= IMAGE PROCESSING =================
function processImage(file){
    video.style.display="none";
    canvas.style.display="block";

    const img = new Image();
    img.onload = ()=>{
        // 2X resolution upscale for detail
        canvas.width = img.width * 2;
        canvas.height = img.height * 2;
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = "high";
        ctx.drawImage(img,0,0,canvas.width,canvas.height);

        enhanceImage();
        addLogo();

        canvas.toBlob(blob=>{
            finalBlob = blob;
            downloadBtn.disabled = false;
            status.textContent = "Image ready (Ultra HD) ✅";
        },"image/png",1.0);
    };
    img.src = URL.createObjectURL(file);
}

// Corporate color enhancement
function enhanceImage(){
    let imgData = ctx.getImageData(0,0,canvas.width,canvas.height);
    let d = imgData.data;
    for(let i=0;i<d.length;i+=4){
        let r=d[i], g=d[i+1], b=d[i+2];
        r*=1.04; g*=1.04; b*=1.04;
        r=(r-128)*1.12+128;
        g=(g-128)*1.12+128;
        b=(b-128)*1.12+128;
        r*=1.02; b*=1.05; // corporate tone
        d[i]=clamp(r);
        d[i+1]=clamp(g);
        d[i+2]=clamp(b);
    }
    ctx.putImageData(imgData,0,0);
}

// Add watermark logo
function addLogo(){
    const scale = canvas.width*0.12/logo.width;
    const w=logo.width*scale;
    const h=logo.height*scale;
    const x=canvas.width-w-30;
    const y=canvas.height-h-30;
    ctx.globalAlpha=.75;
    ctx.drawImage(logo,x,y,w,h);
    ctx.globalAlpha=1;
}

// ================= VIDEO PROCESSING =================
function processVideo(file){
    canvas.style.display="none";
    video.style.display="block";
    const url = URL.createObjectURL(file);
    video.src = url;

    finalBlob = file; // original video
    downloadBtn.disabled = false;
    status.textContent = "Video ready (original quality) ✅\nLogo visible in preview";
}

// ================= DOWNLOAD =================
downloadBtn.addEventListener("click",()=>{
    if(!finalBlob) return;
    const url = URL.createObjectURL(finalBlob);
    const a = document.createElement("a");
    a.href = url;
    a.download = currentType==="image" ? "selelo_branded.png" : "selelo_video.mp4";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
});

function clamp(v){ return Math.max(0,Math.min(255,v)); }
</script>
</body>
</html>
